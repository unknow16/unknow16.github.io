---
title: 08-动态组件
toc: true
date: 2019-07-02 11:45:36
tags:
categories:
---



在不同组件之间进行动态切换是非常有用的，如tab页切换

可以通过 Vue 的 `<component>` 元素加一个特殊的 `is` 特性来实现：

```
<!-- 组件会在 `currentTabComponent` 改变时改变 -->
<component v-bind:is="currentTabComponent"></component>
```

在上述示例中，`currentTabComponent` 可以包括

- 已注册组件的名字，或
- 一个组件的选项对象



## keep-alive

每次切换组件的时候，Vue 都创建了一个新的 `currentTabComponent` 实例，当有需求要组件实例能够被在它们第一次被创建的时候缓存下来时，可以用一个 `<keep-alive>`元素将其动态组件包裹起来。

```
<keep-alive>
  <component v-bind:is="currentTabComponent"></component>
</keep-alive>
```



## 异步组件

1. Vue 允许你以一个工厂函数的方式定义你的组件，这个工厂函数会异步解析你的组件定义。Vue 只有在这个组件需要被渲染的时候才会触发该工厂函数，且会把结果缓存起来供未来重渲染。

```
Vue.component('async-example', function (resolve, reject) {
    // resolve回调函数参数是组件定义
    resolve({
      template: '<div>I am async!</div>'
    })
})
```

- resolve回调函数参数是组件定义

- 调用 `reject(reason)` 来表示加载失败。

2. [webpack 的 code-splitting 功能](https://webpack.js.org/guides/code-splitting/)一起配合使用

```
Vue.component('async-webpack-example', function (resolve) {
  // 这个特殊的 `require` 语法将会告诉 webpack
  // 自动将你的构建代码切割成多个包，这些包
  // 会通过 Ajax 请求加载
  require(['./my-async-component'], resolve)
})
```

3. 你也可以在工厂函数中返回一个 `Promise`，所以把 webpack 2 和 ES2015 语法加在一起，我们可以写成这样：

```
Vue.component(
  'async-webpack-example',
  // 这个 `import` 函数会返回一个 `Promise` 对象。
  () => import('./my-async-component')
)
```

4. 当使用局部注册的时候，你也可以直接提供一个返回 `Promise` 的函数：

```
new Vue({
  // ...
  components: {
    'my-component': () => import('./my-async-component')
  }
})
```

## 参考资料
> - []()
> - []()
