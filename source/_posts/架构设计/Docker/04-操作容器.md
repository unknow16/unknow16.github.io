---
title: 04-操作容器
toc: true
date: 2019-04-27 15:54:40
tags:
categories:
---


## 查看容器

```
// 查看容器
docker container ls

// 要获取容器的输出信息，可以通过 docker container logs 命令
docker container logs [container ID or NAMES]

```

## 启动容器
启动容器有两种方式，一种是基于镜像新建一个容器并启动，另外一个是将在终止
状态（ stopped ）的容器重新启动。
因为 Docker 的容器实在太轻量级了，很多时候用户都是随时删除和新创建容器。

#### 新建并启动
如下通过docker run启动一个容器

```
docker run -it --rm ubuntu:16.04 bash

// docker run 为运行容器的命令
// -it其实是两个参数，-i表示启动交互操作，-t表示采用终端
// --rm 让容器退出后即被删除。默认退出的容器不会被删除，除非主动用docker rm删除。
// ubuntu:16.04 指采用ubuntu:16.04为镜像启动容器
// bash 启动一个shell来执行命令
```

更多的时候，需要让 Docker 在后台运行而不是直接把执行命令的结果输出在当前
宿主机下。此时，可以通过添加docker run -d 参数来实现。

此时容器会在后台运行并不会把输出的结果 (STDOUT) 打印到宿主机上面，输出结
果可以通过如下命令查看。

```
docker logs <container ID or NAMES>
```


当利用 docker run 来创建容器时，Docker 在后台运行的标准操作包括：
1. 检查本地是否存在指定的镜像，不存在就从公有仓库下载
1. 利用镜像创建并启动一个容器
1. 分配一个文件系统，并在只读的镜像层外面挂载一层可读写层
1. 从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中去
1. 从地址池配置一个 ip 地址给容器
1. 执行用户指定的应用程序
1. 执行完毕后容器被终止

#### 启动已终止容器

```
docker container start <container ID or NAMES>
```
容器的核心为所执行的应用程序，所需要的资源都是应用程序运行所必需的。除此
之外，并没有其它的资源。


## 终止容器
```
docker container stop <container ID or NAMES>
```
此外，当 Docker 容器中指定的应用终结时，容器也自动终止。
例如对于上一章节中只启动了一个终端的容器，用户通过 exit 命令或 Ctrl+d
来退出终端时，所创建的容器立刻终止。
终止状态的容器可以用如下命令看到。
```
docker container ls -a
```

## 进入容器
在使用 -d 参数时，容器启动后会进入后台。
某些时候需要进入容器进行操作，包括使用 docker attach 命令或 docker
exec 命令，推荐大家使用 docker exec 命令，因为attach进入从stdin中exit，会导致容器的停止。
```
docker attach <container ID or NAMES>

docker exec -it <container ID or NAMES> bash
```

## 删除容器

```
docker container rm <container ID or NAMES>
```
如果要删除一个运行中的容器，可以添加 -f 参数。Docker 会发送 SIGKILL
信号给容器。

- 清理所有处于终止状态的容器

用 docker container ls -a 命令可以查看所有已经创建的包括终止状态的容
器，如果数量太多要一个个删除可能会很麻烦，用下面的命令可以清理掉所有处于
终止状态的容器。

```
docker container prune
```
